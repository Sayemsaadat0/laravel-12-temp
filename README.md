# Laravel 12 API Backend with Sanctum Authentication

A RESTful API built with Laravel 12 featuring role-based authentication using Laravel Sanctum. This project includes user authentication, role-based access control (User & Admin), and comprehensive user management endpoints.

## Features

- ✅ **User Authentication** - Register, Login, Logout with Sanctum tokens
- ✅ **Role-Based Access Control** - User and Admin roles
- ✅ **User Management** - Update and delete own account
- ✅ **Admin Panel** - Full CRUD operations for user management
- ✅ **API Security** - Bearer token authentication
- ✅ **RESTful API** - Clean and organized API endpoints

## Prerequisites

Before you begin, ensure you have the following installed:

- **PHP** >= 8.2
- **Composer** (PHP package manager)
- **Database** (MySQL, PostgreSQL, or SQLite)
- **Node.js & NPM** (optional, for frontend assets)

## Installation

### Option 1: Fresh Laravel 12 Installation

If you want to create a new Laravel 12 project from scratch:

```bash
# Create new Laravel 12 project
composer create-project laravel/laravel my-api-backend

# Navigate to project directory
cd my-api-backend

# Install Laravel Sanctum
composer require laravel/sanctum

# Publish Sanctum configuration
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"

# Run migrations
php artisan migrate
```

Then follow the setup steps below to configure the project.

### Option 2: Clone Existing Repository

If you're cloning this repository:

```bash
# Clone the repository
git clone https://github.com/yourusername/my-api-backend.git

# Navigate to project directory
cd my-api-backend

# Install PHP dependencies
composer install

# Copy environment file
cp .env.example .env

# Generate application key
php artisan key:generate

# Configure your database in .env file
# Edit .env and set your database credentials

# Run migrations
php artisan migrate

# (Optional) Install frontend dependencies
npm install
```

## Configuration

### Database Setup

Edit the `.env` file and configure your database:

```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=your_database_name
DB_USERNAME=your_username
DB_PASSWORD=your_password
```

**For SQLite (default):**
```env
DB_CONNECTION=sqlite
DB_DATABASE=/absolute/path/to/database.sqlite
```

Or use the default SQLite file:
```bash
touch database/database.sqlite
```

### Environment Variables

Make sure your `.env` file has the following configured:

```env
APP_NAME="Laravel API"
APP_ENV=local
APP_KEY=base64:... (generated by key:generate)
APP_DEBUG=true
APP_URL=http://localhost:8000
```

## Running the Application

```bash
# Start the development server
php artisan serve

# The API will be available at http://localhost:8000
```

## API Endpoints

### Base URL
```
http://localhost:8000/api
```

### Public Routes

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/register` | Register a new user |
| POST | `/api/login` | Login user and get token |

### Authenticated User Routes

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/logout` | Logout user | ✅ Bearer Token |
| GET | `/api/user` | Get authenticated user | ✅ Bearer Token |
| PUT | `/api/user/update` | Update authenticated user | ✅ Bearer Token |
| DELETE | `/api/user/delete` | Delete authenticated user | ✅ Bearer Token |

### Admin Routes

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/dashboard` | Get dashboard stats | ✅ Admin Token |
| GET | `/api/admin/users` | Get all users | ✅ Admin Token |
| GET | `/api/admin/users/{id}` | Get user by ID | ✅ Admin Token |
| POST | `/api/admin/users` | Create new user | ✅ Admin Token |
| PUT | `/api/admin/users/{id}` | Update user | ✅ Admin Token |
| DELETE | `/api/admin/users/{id}` | Delete user | ✅ Admin Token |

## API Usage Examples

### Register User
```bash
POST /api/register
Content-Type: application/json

{
    "name": "John Doe",
    "email": "john@example.com",
    "password": "password123",
    "password_confirmation": "password123"
}
```

### Login
```bash
POST /api/login
Content-Type: application/json

{
    "email": "john@example.com",
    "password": "password123"
}
```

### Get Authenticated User
```bash
GET /api/user
Authorization: Bearer {your_token_here}
```

### Update User
```bash
PUT /api/user/update
Authorization: Bearer {your_token_here}
Content-Type: application/json

{
    "name": "Updated Name",
    "email": "newemail@example.com"
}
```

## Creating an Admin User

To create an admin user, use Laravel Tinker:

```bash
php artisan tinker
```

Then run:
```php
use App\Models\User;
use Illuminate\Support\Facades\Hash;

User::create([
    'name' => 'Admin User',
    'email' => 'admin@example.com',
    'password' => Hash::make('password123'),
    'role' => 'admin'
]);
```

## Postman Collection

Import the `postman_collection.json` file into Postman for easy API testing. The collection includes all endpoints with example requests.

## Project Structure

```
my-api-backend/
├── app/
│   ├── Http/
│   │   ├── Controllers/
│   │   │   └── Api/
│   │   │       ├── AuthController.php    # Authentication endpoints
│   │   │       └── AdminController.php       # Admin endpoints
│   │   └── Middleware/
│   │       └── RoleMiddleware.php            # Role-based access control
│   └── Models/
│       └── User.php                          # User model with roles
├── database/
│   └── migrations/
│       ├── 0001_01_01_000000_create_users_table.php
│       └── 2025_11_08_043418_add_role_to_users_table.php
├── routes/
│   └── api.php                               # API routes
├── config/
│   └── sanctum.php                           # Sanctum configuration
└── bootstrap/
    └── app.php                               # Application bootstrap
```

## Technologies Used

- **Laravel 12** - PHP Framework
- **Laravel Sanctum** - API Authentication
- **PHP 8.2+** - Programming Language

## Testing

```bash
# Run tests
php artisan test
```

## Troubleshooting

### Common Issues

1. **"Route [api] not found"**
   - Ensure `bootstrap/app.php` includes API routes
   - Check that `routes/api.php` exists

2. **"Class 'Laravel\Sanctum\HasApiTokens' not found"**
   - Run: `composer require laravel/sanctum`
   - Run: `composer dump-autoload`

3. **Database connection errors**
   - Check `.env` file configuration
   - Ensure database exists
   - Run: `php artisan config:clear`

4. **Migration errors**
   - Run: `php artisan migrate:fresh` (⚠️ This deletes all data)
   - Or: `php artisan migrate:rollback` then `php artisan migrate`

## License

The Laravel framework is open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).

## Contributing

Thank you for considering contributing to this project! Please feel free to submit pull requests or open issues for bugs and feature requests.

## Support

For support, email your-email@example.com or open an issue in the repository.
